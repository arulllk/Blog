const mongoose=require("mongoose"),blogSchema=new mongoose.Schema({title:{type:String,required:[!0,"Title can't be empty"],minlength:[5,"Title must be greater than 5 characters"],maxlength:[100,"Title must be 100 characters or fewer"]},content:{type:String,required:[!0,"Blog content can't be empty"]},topic:{type:String,required:[!0,"Topic can't be empty"]},seoTitle:{type:String},seoDescription:{type:String},image:{type:String,required:[!0,"Please add image"]},altImage:{type:String,required:[!0,"Please add alt text to show on image for seo purpose"]},status:{type:Boolean,default:!1},slug:{type:String,unique:!0}},{timestamps:!0});blogSchema.pre("save",(async function(next){if(!this.isModified("title"))return next();const slugBase=this.title.toLowerCase().replace(/ /g,"-").replace(/[^\w-]+/g,"");let slug=slugBase,suffix=1;for(;await mongoose.models.Blog.findOne({slug:slug});)slug=`${slugBase}-${suffix}`,suffix++;this.slug=slug,next()})),module.exports=mongoose.model("Blog",blogSchema);